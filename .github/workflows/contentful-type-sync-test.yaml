name: contentful-type-sync-test
on:
  repository_dispatch:
    types: [contentful-sync]

jobs:
  test:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v2

      - name: Set up Node.js
        uses: actions/setup-node@v2
        with:
          node-version: "14"

      - name: Run server to log POST request
        run: |
          nohup node server.js > server.log 2>&1 &
          echo "Server is running..."
          sleep 5  # Give the server some time to start

      - name: Run Contentful Type Sync
        run: |
          echo "Running Contentful Type Sync..."
          # Add your sync logic here

      - name: Display server logs
        run: cat server.log
